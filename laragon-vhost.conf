# Laragon Virtual Host Configuration
# Spara denna fil som: C:\laragon\etc\apache2\sites-enabled\deltagarportal.conf
# Starta sedan om Apache i Laragon

<VirtualHost *:80>
    DocumentRoot "C:/laragon/www/deltagarportal/client/dist"
    ServerName deltagarportal.test
    ServerAlias *.deltagarportal.test
    
    <Directory "C:/laragon/www/deltagarportal/client/dist">
        AllowOverride All
        Require all granted
        Options -Indexes +FollowSymLinks
    </Directory>
    
    # Proxy för API-anrop till backend
    ProxyPreserveHost On
    ProxyPass /api http://localhost:3001/api
    ProxyPassReverse /api http://localhost:3001/api
    
    # Loggar
    ErrorLog "C:/laragon/var/log/apache/deltagarportal-error.log"
    CustomLog "C:/laragon/var/log/apache/deltagarportal-access.log" combined
</VirtualHost>

# Utvecklings-vhost (för Vite dev server)
<VirtualHost *:80>
    DocumentRoot "C:/laragon/www/deltagarportal/client"
    ServerName dev.deltagarportal.test
    
    <Directory "C:/laragon/www/deltagarportal/client">
        AllowOverride All
        Require all granted
        Options -Indexes +FollowSymLinks
    </Directory>
    
    # Proxy för Vite dev server
    ProxyPreserveHost On
    ProxyPass / http://localhost:5173/
    ProxyPassReverse / http://localhost:5173/
    
    # WebSocket-stöd för Vite HMR
    RewriteEngine on
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/?(.*) "ws://localhost:5173/$1" [P,L]
</VirtualHost>
